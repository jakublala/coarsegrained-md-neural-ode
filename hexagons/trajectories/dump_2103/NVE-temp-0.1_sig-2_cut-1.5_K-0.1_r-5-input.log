
# -------------------------- ATOMS/MOLECULE DEFINITION --------------------------
read_data hex.conf                                  # Add a hexagon molecule
  orthogonal box = (-25 -25 -25) to (25 25 25)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  7 atoms
  scanning bonds ...
  6 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  reading bonds ...
  12 bonds
  reading angles ...
  11 angles
  6 = max # of 1-2 neighbors
  12 = max # of 1-3 neighbors
  36 = max # of 1-4 neighbors
  6 = max # of special neighbors
  special bonds CPU = 0.0006371 secs
  read_data CPU = 0.0150171 secs
read_data hex.conf add append shift 1.0 1.0 2.0   # Add a second identical molecule, shifted so it doesn't overlap
  orthogonal box = (-25 -25 -25) to (26 26 27)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  7 atoms
  scanning bonds ...
  6 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  reading bonds ...
  12 bonds
  reading angles ...
  11 angles
  6 = max # of 1-2 neighbors
  12 = max # of 1-3 neighbors
  36 = max # of 1-4 neighbors
  6 = max # of special neighbors
  special bonds CPU = 0.0002124 secs
  read_data CPU = 0.001851 secs

# Group ID can be used in other commands, including fix, compute, dump or velocity
group hex_1 id 1 2 3 4 5 6 7                    # label the atoms 1-7 as a group
7 atoms in group hex_1
group hex_2 id 8 9 10 11 12 13 14               # label the atoms 8-14 as another group
7 atoms in group hex_2

# -------------------------------- SYSTEM FIX -----------------------------------
# hold hex_1 group as a rigid body defined by a "molecule", /small is simply an implementation detail
# langevin -> Tstart Tstop damp seed
fix rig_hex_1 hex_1 rigid/nve/small molecule    langevin ${temp} ${temp} 10 428984
fix rig_hex_1 hex_1 rigid/nve/small molecule    langevin 0.1 ${temp} 10 428984
fix rig_hex_1 hex_1 rigid/nve/small molecule    langevin 0.1 0.1 10 428984
  create bodies CPU = 9.71e-05 secs
1 rigid bodies with 7 atoms
  1 = max distance from body owner to body atom
fix rig_hex_2 hex_2 rigid/nve/small molecule    langevin ${temp} ${temp} 10 123456
fix rig_hex_2 hex_2 rigid/nve/small molecule    langevin 0.1 ${temp} 10 123456
fix rig_hex_2 hex_2 rigid/nve/small molecule    langevin 0.1 0.1 10 123456
  create bodies CPU = 8e-06 secs
1 rigid bodies with 7 atoms
  1 = max distance from body owner to body atom
# fix rig_hex_1 hex_1 rigid/nvt/small molecule temp 0.5 0.5 1.0 tparam 5 3 3
# fix rig_hex_2 hex_2 rigid/nvt/small molecule temp 0.5 0.5 1.0 tparam 5 3 3

fix hex_spring hex_1 spring couple hex_2 ${K} 0.0 0.0 0.0 ${r0} # adds harmonic spring between rigid bodies
fix hex_spring hex_1 spring couple hex_2 0.1 0.0 0.0 0.0 ${r0} 
fix hex_spring hex_1 spring couple hex_2 0.1 0.0 0.0 0.0 5 
# f_hex_spring[1,2,3,4] = force_x, force_y, force_z, magnitude of the force

neigh_modify exclude molecule/intra hex_1       # don't compute pair interactions within rigid body
neigh_modify exclude molecule/intra hex_2       # don't compute pair interactions within rigid body

# ---------------------------- PROPERTY COMPUTES --------------------------------
# Calculate rigid body properties - local data, so much be outputted using
compute mass_1  all rigid/local rig_hex_1 mass                      # RB1 mass
compute mass_2  all rigid/local rig_hex_2 mass                      # RB2 mass
compute com_1   all rigid/local rig_hex_1 x y z                     # RB1 center of mass x, y, z
compute com_2   all rigid/local rig_hex_2 x y z                     # RB2 center of mass x, y, z
compute vel_1   all rigid/local rig_hex_1 vx vy vz                  # RB1 center of mass velocities vx, vy, vz
compute vel_2   all rigid/local rig_hex_2 vx vy vz                  # RB2 center of mass velocities vx, vy, vz
compute q_1     all rigid/local rig_hex_1 quati quatj quatk quatw   # RB1 quaternion components
compute q_2     all rigid/local rig_hex_2 quati quatj quatk quatw   # RB2 quaternion components
compute av_1    all rigid/local rig_hex_1 omegax omegay omegaz      # RB1 angular velocities
compute av_2    all rigid/local rig_hex_2 omegax omegay omegaz      # RB2 angular velocities
compute am_1    all rigid/local rig_hex_1 angmomx angmomy angmomz   # RB1 angular momenta
compute am_2    all rigid/local rig_hex_2 angmomx angmomy angmomz   # RB2 angular momenta

# -------------------------- INTERATOMIC POTENTIALS -----------------------------
# Pairwise potentials
pair_style  lj/cut  ${cut}                         # lj truncated - cutoff at 1.12 sigma
pair_style  lj/cut  1.5                         
pair_coeff  *   *   1.0 ${sigma}                     # epsilon | sigma - * * means all atoms interact with each other
pair_coeff  *   *   1.0 2                     

################################## SIMULATION ###################################
# ----------------------------- CONFIGURE OUTPUTS -------------------------------
thermo  1000 # print values to terminal and in file log.lammps
thermo_style custom step f_hex_spring[*] temp pe ke etotal

dump    1 all custom 1000 ${traj}       id type x y z
dump    1 all custom 1000 dump/NVE-temp-0.1_sig-2_cut-1.5_K-0.1_r-5-traj.dump       id type x y z
dump    2 all local  1000 ${rb_info}  c_com_1[*] c_com_2[*] c_vel_1[*] c_vel_2[*] c_q_1[*] c_q_2[*] c_av_1[*] c_av_2[*] c_am_1[*] c_am_2[*]
dump    2 all local  1000 dump/NVE-temp-0.1_sig-2_cut-1.5_K-0.1_r-5-info.dump  c_com_1[*] c_com_2[*] c_vel_1[*] c_vel_2[*] c_q_1[*] c_q_2[*] c_av_1[*] c_av_2[*] c_am_1[*] c_am_2[*]

log ${sim_log} # create new log file with simulation information only
log dump/NVE-temp-0.1_sig-2_cut-1.5_K-0.1_r-5-sim.log 
